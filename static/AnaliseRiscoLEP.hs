{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE DeriveGeneric #-}

module Main where

import Data.Aeson
import qualified Data.ByteString.Lazy as BSL
import Data.Text (pack)
import Data.Text.Encoding (encodeUtf8)
import GHC.Generics
import Text.Printf

data Apenado = Apenado {
    idApenado :: Int,
    nome :: String,
    apelido :: Maybe String,
    natureza :: String,
    reincidente :: Bool,
    penaTotal :: Double,
    tempoCumprido :: Double,
    bomComportamento :: Bool,
    regimeAtual :: String,
    dataPrisao :: Maybe String,
    dataProgressao :: Maybe String,
    creditosRemissao :: Double,
    historicoRegimes :: Value,
    periculosidade :: Double
} deriving (Show, Generic)

instance FromJSON Apenado
instance ToJSON Apenado

-- Full JSON data from the initial prompt
jsonString :: String
jsonString = "[{\"idApenado\":1,\"nome\":\"Maria Silva\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":false,\"penaTotal\":10.37,\"tempoCumprido\":3.7199999999999998,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.68},{\"idApenado\":2,\"nome\":\"Marcos Santos\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":false,\"penaTotal\":4.83,\"tempoCumprido\":3.23,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.51},{\"idApenado\":3,\"nome\":\"JoÃ£o Costa\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":false,\"penaTotal\":9.73,\"tempoCumprido\":5.87,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.76},{\"idApenado\":4,\"nome\":\"Pedro Alves\",\"apelido\":null,\"natureza\":\"CrimeHediondo\",\"reincidente\":false,\"penaTotal\":8.04,\"tempoCumprido\":6.85,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.1},{\"idApenado\":5,\"nome\":\"Roberto Santos\",\"apelido\":null,\"natureza\":\"CrimeHediondo\",\"reincidente\":false,\"penaTotal\":19.7,\"tempoCumprido\":10.95,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.54},{\"idApenado\":6,\"nome\":\"Roberto Santos\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":false,\"penaTotal\":25.56,\"tempoCumprido\":10.9,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.58},{\"idApenado\":7,\"nome\":\"Maria Silva\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":true,\"penaTotal\":24.1,\"tempoCumprido\":14.87,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.87},{\"idApenado\":8,\"nome\":\"Roberto Pereira\",\"apelido\":null,\"natureza\":\"CrimeHediondoComMorte\",\"reincidente\":false,\"penaTotal\":8.23,\"tempoCumprido\":4.46,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.27},{\"idApenado\":9,\"nome\":\"Maria Oliveira\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":8.25,\"tempoCumprido\":4.57,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.69},{\"idApenado\":10,\"nome\":\"Ana Lima\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":25.37,\"tempoCumprido\":13.21,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.27},{\"idApenado\":11,\"nome\":\"Ana Lima\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":14.29,\"tempoCumprido\":9.530000000000001,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.14},{\"idApenado\":12,\"nome\":\"Pedro Costa\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":false,\"penaTotal\":23.42,\"tempoCumprido\":8.02,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.4},{\"idApenado\":13,\"nome\":\"Ana Oliveira\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":false,\"penaTotal\":6.36,\"tempoCumprido\":3.15,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.15},{\"idApenado\":14,\"nome\":\"Pedro Alves\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":14.0,\"tempoCumprido\":7.17,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.53},{\"idApenado\":15,\"nome\":\"Marcos Silva\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":true,\"penaTotal\":21.72,\"tempoCumprido\":8.83,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.77},{\"idApenado\":16,\"nome\":\"Fernanda Santos\",\"apelido\":null,\"natureza\":\"CrimeHediondo\",\"reincidente\":false,\"penaTotal\":8.11,\"tempoCumprido\":3.01,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.97},{\"idApenado\":17,\"nome\":\"Pedro Santos\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":false,\"penaTotal\":25.88,\"tempoCumprido\":9.57,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.15},{\"idApenado\":18,\"nome\":\"Pedro Silva\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":false,\"penaTotal\":16.7,\"tempoCumprido\":3.93,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.88},{\"idApenado\":19,\"nome\":\"Carlos Costa\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":26.83,\"tempoCumprido\":15.7,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.73},{\"idApenado\":20,\"nome\":\"Maria Oliveira\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":28.62,\"tempoCumprido\":5.359999999999999,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.87},{\"idApenado\":21,\"nome\":\"Roberto Costa\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":22.54,\"tempoCumprido\":7.5,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.65},{\"idApenado\":22,\"nome\":\"Juliana Martins\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":9.84,\"tempoCumprido\":4.66,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.55},{\"idApenado\":23,\"nome\":\"Luiza Costa\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":22.4,\"tempoCumprido\":3.66,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.91},{\"idApenado\":24,\"nome\":\"Fernanda Santos\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":11.24,\"tempoCumprido\":5.73,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.13},{\"idApenado\":25,\"nome\":\"Luiza Martins\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":24.99,\"tempoCumprido\":5.38,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.66},{\"idApenado\":26,\"nome\":\"Fernanda Alves\",\"apelido\":null,\"natureza\":\"CrimeHediondoComMorte\",\"reincidente\":false,\"penaTotal\":26.46,\"tempoCumprido\":3.7199999999999998,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.98},{\"idApenado\":27,\"nome\":\"Maria Silva\",\"apelido\":null,\"natureza\":\"CrimeHediondoComMorte\",\"reincidente\":false,\"penaTotal\":24.82,\"tempoCumprido\":4.36,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.19},{\"idApenado\":28,\"nome\":\"Juliana Oliveira\",\"apelido\":null,\"natureza\":\"CrimeHediondoComMorte\",\"reincidente\":true,\"penaTotal\":11.24,\"tempoCumprido\":4.4,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.44},{\"idApenado\":29,\"nome\":\"Marcos Santos\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":29.19,\"tempoCumprido\":16.52,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.17},{\"idApenado\":30,\"nome\":\"Juliana Martins\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":27.46,\"tempoCumprido\":5.26,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.99},{\"idApenado\":31,\"nome\":\"Carlos Martins\",\"apelido\":null,\"natureza\":\"CrimeHediondo\",\"reincidente\":false,\"penaTotal\":22.11,\"tempoCumprido\":11.08,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.66},{\"idApenado\":32,\"nome\":\"Juliana Oliveira\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":9.66,\"tempoCumprido\":3.2800000000000002,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.06},{\"idApenado\":33,\"nome\":\"Fernanda Silva\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":false,\"penaTotal\":17.07,\"tempoCumprido\":10.280000000000001,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.06},{\"idApenado\":34,\"nome\":\"Marcos Santos\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":true,\"penaTotal\":19.47,\"tempoCumprido\":9.57,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.4},{\"idApenado\":35,\"nome\":\"Luiza Costa\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":20.1,\"tempoCumprido\":7.21,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.57},{\"idApenado\":36,\"nome\":\"Fernanda Pereira\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":10.21,\"tempoCumprido\":5.02,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.65},{\"idApenado\":37,\"nome\":\"Juliana Lima\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":15.92,\"tempoCumprido\":10.95,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.07},{\"idApenado\":38,\"nome\":\"Ana Pereira\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":false,\"penaTotal\":26.9,\"tempoCumprido\":14.83,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.28},{\"idApenado\":39,\"nome\":\"Juliana Pereira\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":21.36,\"tempoCumprido\":8.92,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.1},{\"idApenado\":40,\"nome\":\"Pedro Pereira\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":23.3,\"tempoCumprido\":4.8100000000000005,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.6},{\"idApenado\":41,\"nome\":\"Fernanda Costa\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":false,\"penaTotal\":17.14,\"tempoCumprido\":5.15,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.09},{\"idApenado\":42,\"nome\":\"Roberto Pereira\",\"apelido\":null,\"natureza\":\"CrimeComumSemViolencia\",\"reincidente\":true,\"penaTotal\":12.67,\"tempoCumprido\":3.83,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.16},{\"idApenado\":43,\"nome\":\"Juliana Alves\",\"apelido\":null,\"natureza\":\"CrimeContraAdministracao\",\"reincidente\":true,\"penaTotal\":6.91,\"tempoCumprido\":6.27,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.55},{\"idApenado\":44,\"nome\":\"Fernanda Oliveira\",\"apelido\":null,\"natureza\":\"CrimeHediondoComMorte\",\"reincidente\":true,\"penaTotal\":5.09,\"tempoCumprido\":3.93,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.9},{\"idApenado\":45,\"nome\":\"Ana Costa\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":true,\"penaTotal\":13.2,\"tempoCumprido\":6.7,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.97},{\"idApenado\":46,\"nome\":\"Pedro Costa\",\"apelido\":null,\"natureza\":\"CrimeComumComViolencia\",\"reincidente\":true,\"penaTotal\":26.92,\"tempoCumprido\":3.33,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.78},{\"idApenado\":47,\"nome\":\"Roberto Costa\",\"apelido\":null,\"natureza\":\"CrimeHediondo\",\"reincidente\":true,\"penaTotal\":24.47,\"tempoCumprido\":4.32,\"bomComportamento\":false,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.86},{\"idApenado\":48,\"nome\":\"Ana Costa\",\"apelido\":null,\"natureza\":\"CrimeHediondoComMorte\",\"reincidente\":false,\"penaTotal\":11.93,\"tempoCumprido\":7.74,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.22},{\"idApenado\":49,\"nome\":\"Ana Alves\",\"apelido\":null,\"natureza\":\"CrimeHediondo\",\"reincidente\":false,\"penaTotal\":26.47,\"tempoCumprido\":15.8,\"bomComportamento\":true,\"regimeAtual\":\"SemiAberto\",\"dataPrisao\":null,\"dataProgressao\":\"2026-01-12T13:22:38.447024\",\"creditosRemissao\":182.5,\"historicoRegimes\":[[\"SemiAberto\",\"2026-01-12T13:22:38.447024\"]],\"periculosidade\":0.35},{\"idApenado\":50,\"nome\":\"Marcos Alves\",\"apelido\":null,\"natureza\":\"CrimeOrganizado\",\"reincidente\":false,\"penaTotal\":28.42,\"tempoCumprido\":4.64,\"bomComportamento\":true,\"regimeAtual\":\"Fechado\",\"dataPrisao\":null,\"dataProgressao\":null,\"creditosRemissao\":182.5,\"historicoRegimes\":[],\"periculosidade\":0.18}]"

jsonData :: BSL.ByteString
jsonData = BSL.fromStrict . encodeUtf8 . pack $ jsonString

-- C# logic translated to Haskell
isEligibleForParole :: Apenado -> Bool
isEligibleForParole apenado =
    bomComportamento apenado &&
    regimeAtual apenado == "Fechado" &&
    periculosidade apenado < 0.5

calcularPenaRemanescente :: Apenado -> Double
calcularPenaRemanescente apenado =
    let anosRemidos = creditosRemissao apenado / 365.0
    in penaTotal apenado - tempoCumprido apenado - anosRemidos

main :: IO ()
main = do
    let decodedData = eitherDecode jsonData :: Either String [Apenado]
    case decodedData of
        Left err -> do
            putStrLn "Error decoding JSON:"
            putStrLn err
        Right apenados -> do
            putStrLn "Analise de Risco LEP - Candidatos a Progressao de Regime:"
            let eligible = filter isEligibleForParole apenados
            mapM_ (\a -> printf "Nome: %s | Pena Remanescente: %.2f anos\n" (nome a) (calcularPenaRemanescente a)) eligible
